{% extends 'website/base.html' %}
{% load static %}

<head>
	<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
	<link rel="stylesheet" href="//resources/demos/style.css">
	<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
	<script src ="{% static "js/datepicker.js" %}"></script>
</head>

<body>
	{% block title %}
		Purchases
	{% endblock %}

	{% block content %}
		<div>
			<h3>Filter Purchases</h3>
			<form action="/purchases/" method="post" autocomplete="off">
				{% csrf_token %}
				<p>Travelling After: <input type="text" name="startdate" id="datepicker1"></p>
				<p>Travelling Before: <input type="text" name="enddate" id="datepicker2"></p>
				<p>Mode of Transport: <select name="mode" id="mode">
					<option value="None">None</option>
					{% for m in modes %}
						<option id="mode" value="{% autoescape off %}{{ m.id }}{% endautoescape %}">{{m.short_desc}}</option>
					{% endfor %}
				</select></p>
				<p><input type="submit" value="Filter"></p>
			</form>
		</div>

		{% if mode and mode != "None" %}
			{% if startdate and enddate %}
				<h4>Displaying {{ mode }} tickets between {{ startdate.date }} and {{ enddate.date }}</h4>
			{% elif startdate %}
				<h4>Displaying {{ mode }} tickets after {{ startdate }}</h4>
			{% elif enddate %}
				<h4>Displaying {{ mode }} tickets before {{ enddate }}</h4>
			{% else %}
				<h4>Displaying {{ mode }} tickets for the next 30 days</h4>
			{% endif %}
		{% else %}
			{% if startdate and enddate %}
				<h4>Displaying all tickets between {{ startdate.date }} and {{ enddate.date }}</h4>
			{% elif startdate %}
				<h4>Displaying all tickets after {{ startdate }}</h4>
			{% elif enddate %}
				<h4>Displaying all tickets before {{ enddate }}</h4>
			{% else %}
				<h4>Displaying all tickets for the next 30 days</h4>
			{% endif %}
		{% endif %}

		{% for p in purchases %}
			<div>
				<p>ID: {{ p.id }}</p>
				<p>Departs: {{ p.travel_from_date_time }}</p>
			</div>
			{% empty %}<p>No purchases to display.</p>
		{% endfor %}
	{% endblock %}
</body>
